tty: true

driver:
  kind: "modern_ebpf"

collectors:
  crio:
    enabled: true
  docker:
    enabled: false
  containerd:
    enabled: true
  kubernetes:
    enabled: false

falco:
  grpc:
    enabled: true
    threadiness: 8
    bind_address: "unix:///run/falco/falco.sock"
  grpc_output:
    enabled: true
  rules_file:
    - "/etc/falco/rules.d"
    - "/etc/falco/falco_rules.yaml"
    - "/etc/falco/k8s_audit_rules.yaml"
  metrics:
    enabled: true
    interval: "15m"
    output_rule: true
    libbpf_stats_enabled: true
    convert_memory_to_mb: true
    include_empty_values: true
    state_counters_enabled: true
    resource_utilization_enabled: true
    kernel_event_counters_enabled: true

resources:
  requests:
    cpu: "200m"
    memory: "192Mi"
  limits:
    cpu: "200m"
    memory: "512Mi"

nodeSelector:
  kubernetes.io/os: "linux"

tolerations:
  - operator: "Exists"
